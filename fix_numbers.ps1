# 修复文件夹序号以匹配PDF文件序号

# 创建文件夹名称与正确序号的映射
$folderMapping = @{
    # 当前名称 => 正确序号
    "1 梵音陀罗尼-佛顶系列咒语 _audio" = "1"
    "346 梵音陀罗尼-大佛顶、大佛顶心、大胜金刚顶真实大三昧耶、炽盛光佛顶、大力佛顶、一切如来金刚最胜王义利坚固爱染王_audio" = "2"
    "352 梵音陀罗尼-佛顶尊胜、诸佛心能令一切众生安乐、一切佛心、菩提场庄严、宝箧印、佛心_audio" = "3"
    "106 梵音陀罗尼-毗卢遮那、释迦牟尼、阿閦、宝生、无量光、观自在王、如来大慈、大力大护、十力、袈裟、心印、跋折罗_audio" = "4"
    "854 梵音陀罗尼-净眼王、宝髻、药师瑠璃光等各个如来的陀罗尼，文殊师利宝藏陀罗尼经咒语_audio" = "5"
    "847 梵音陀罗尼-般若波罗蜜多、佛眼、七俱胝佛母、准提、大孔雀明王、无染着、金胜佛母陀罗尼_audio" = "6"
    "262 梵音陀罗尼-大宝积经无边庄严会无上陀罗尼(无上清净陀罗尼)、出现光明会殊胜陀罗尼_audio" = "7"
    "756 梵音陀罗尼-出生无边门、宝楼阁善住秘密、大随求、《虚空藏菩萨问七佛陀罗尼咒经》陀罗尼_audio" = "8"
    "9 无垢净光、智矩、大般涅盘经摧魔、持世、花聚、胜幢臂、一切诸法入无量门-A4 20241001_audio" = "9"
    "994 梵音陀罗尼-文殊师利菩萨陀罗尼 普贤菩萨陀罗尼_audio" = "10"
    "380 梵音陀罗尼-千臂千眼千头千足千舌大悲根本陀罗尼 观自在菩萨根本真言 马首明王陀罗尼 十一面圣观自在菩萨陀罗尼_audio" = "11"
    "650 梵音陀罗尼-观自在、白衣观自在、多罗观自在、毗俱胝观自在_audio" = "12"
    "420 梵音陀罗尼-青颈大悲观自在、千句大悲咒_audio" = "13"
    "14 梵音陀罗尼-不空羂索心王母、秘密心、秘密小心、自在王、心、心中心、身印陀罗尼。圣观自在菩萨千转灭罪、阿末[齿来]观自在、如意轮、观自在甘露、观自在闻持、观自在心_audio" = "14"
    "111 梵音陀罗尼-观自在、叶衣观自在、香王观自在、圣观自在、圣高髻王、能满诸愿王圣观自在菩萨陀罗尼卍_audio" = "15"
    "285 梵音陀罗尼-广大不空摩尼宝、最胜明王、奋怒王、悉地王、吉祥莲花、功德天与一切愿、大吉祥莲花心、普遍心印_audio" = "16"
    "305 梵音陀罗尼-不思议观、敬礼三昧耶、布施、净戒、安忍、精进、静_audio" = "17"
    "569 梵音陀罗尼-请召观世音菩萨、观自在奉送发遣、不空王根本莲华顶摩尼心、无垢宝莲花顶、溥遍解脱、大奋怒王_audio" = "18"
    "265 梵音陀罗尼-不空大可畏明王央俱舍、清净莲华明王央俱舍、不空思惟宝光、不空大灌顶光、不空金刚灌顶、不空摩尼供养、明王、观自在菩萨说一髻大罗剎尊_audio" = "19"
    "192 梵音陀罗尼-圣观自在菩萨闻持、除怖畏、除贼、灭罪、治各种病陀罗尼_audio" = "20"
    "565 梵音陀罗尼-大势至、金刚手、弥勒、虚空藏、地藏、除盖障、无垢称、月光、无尽意、月光童子、药王陁罗尼、灭恶趣、除忧暗菩萨_audio" = "21"
    "22 月藏菩萨、六门、八名普密、变食真言、楞伽经、除一切毒、思益经、降甘雨、止风雨、止恶风雹雨_audio" = "22"
    "549 梵音陀罗尼-基本的陀罗尼、治病、护命法门和妙法莲花经陀罗尼_audio" = "23"
    "764 梵音陀罗尼-不动尊+无能胜+莽鸡菩萨_audio" = "24"
    "127 梵音陀罗尼-阎曼德迦、步掷金刚、降三世、金刚手逊婆、金刚手的陀罗尼_audio" = "25"
    "126 梵音陀罗尼-军吒利明王_audio" = "26"
    "501 梵音陀罗尼-大力金刚(秽迹金刚)、大力乌蒭涩摩、金刚商羯罗_audio" = "27"
    "210 梵音陀罗尼-大可畏忿怒金刚笑明王、金翅鸟王、蘖噜拏王、大罗剎斯、圣迦抳金刚童子、大青面金刚、大元师药叉、阿吒婆拘鬼神、正了知药叉_audio" = "28"
    "800 梵音陀罗尼-蘘麌梨童女、摩利支天女、大吉祥天女、大辩才天女、佛伽那钵底圣者除障难陀罗尼_audio" = "29"
    "289 梵音陀罗尼-天部、天女的陀罗尼_audio" = "30"
}

# 重命名文件夹
foreach ($currentName in $folderMapping.Keys) {
    $correctNumber = $folderMapping[$currentName]
    
    # 提取文件夹名称的主要部分（移除当前序号）
    $mainNameMatch = [regex]::Match($currentName, "^\d+ (.+)$")
    if ($mainNameMatch.Success) {
        $mainName = $mainNameMatch.Groups[1].Value
        $newName = "$correctNumber $mainName"
        
        if (Test-Path $currentName -PathType Container) {
            Write-Host "重命名文件夹: $currentName -> $newName"
            Rename-Item -Path $currentName -NewName $newName -Force
        } else {
            Write-Host "文件夹不存在: $currentName"
        }
    } else {
        Write-Host "无法解析文件夹名称: $currentName"
    }
}

Write-Host "序号修复完成!" 